*** Settings ***
Library           Selenium2Library
Resource          Lib/Flow.txt
Library           Screenshot
Library           AutoItLibrary
Library           OperatingSystem
Library           mylib
Library           ExcelLibrary
Library           Collections
Resource          ../ComLib/Flow.txt

*** Test Cases ***
设置期望结果（非首次请勿勾选）
    login
    Page Should Not Contain Button    ${btn_login}
    log    用户登录成功
    GotoDBviewer
    SearchIntoDB    ${dbname}
    select frame    ${frame_viewer}
    ${loop}    ${time}    GetScrollInfo
    Capture Page Screenshot    ${dbname}.png
    #截取当前页面DB
    copy file    ${logpath}${dbname}.png    F:\\screen\\expect
    #将截图复制到实际结果文件夹
    : FOR    ${i}    IN RANGE    ${loop}
    \    focus    ${scroll_viewerDB}
    \    Mouse click    ${scroll_viewerDB}
    \    Mouse Over    ${scroll_viewerDB}
    \    Mouse Wheel    Down    ${time}
    \    sleep    2s
    \    Capture Page Screenshot    ${dbname}${i}.png
    \    #截取当前页面DB
    \    copy file    ${logpath}${dbname}${i}.png    F:\\screen\\expect
    \    #将截图复制到实际结果文件夹
    \    Comment    ${result}    compare    ${dbname}
    unselect frame

校验DB
    login
    Page Should Not Contain Button    ${btn_login}
    log    用户登录成功
    GotoDBviewer
    SearchIntoDB    ${dbname}
    select frame    ${frame_viewer}
    ${loop}    ${time}    GetScrollInfo
    Capture Page Screenshot    ${dbname}.png
    #截取当前页面DB
    copy file    ${logpath}${dbname}.png    F:\\screen\\result
    #将截图复制到实际结果文件夹
    ${result}    compare    ${dbname}
    Run Keyword If    "${result}"=='true'    log    DB：${dbname}校验成功，与预期结果一致
    ...    ELSE    log    DB：${dbname}校验失败，请手动查看    WARN
    Comment    should be true    "${result}"=='true'    DB：${dbname}校验失败，请手动查看
    : FOR    ${i}    IN RANGE    ${loop}
    \    focus    ${scroll_viewerDB}
    \    Mouse click    ${scroll_viewerDB}
    \    Mouse Over    ${scroll_viewerDB}
    \    Mouse Wheel    Down    ${time}
    \    sleep    2s
    \    Capture Page Screenshot    ${dbname}${i}.png
    \    #截取当前页面DB
    \    copy file    ${logpath}${dbname}${i}.png    F:\\screen\\result
    \    #将截图复制到实际结果文件夹
    \    Comment    ${result}    compare    ${dbname}
    \    ${result}    compare    ${dbname}${i}
    \    Run Keyword If    "${result}"=='true'    log    DB：${dbname}第${i}部分校验成功，与预期结果一致
    \    ...    ELSE    log    DB：${dbname}第${i}部分校验失败，请手动查看    WARN
    \    Comment    should be true    "${result}"=='true'    DB：${dbname}第${i}部分校验失败，请手动查看
